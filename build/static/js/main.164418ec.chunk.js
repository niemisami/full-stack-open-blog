(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,n){e.exports=n(69)},69:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(29),o=n.n(c),u=n(4),i=n(16),l=n(32),s=n(33),p=n(15),m=0,f=1,h="BLOGS_FETCH",d="BLOG_CREATE",b="BLOG_UPDATE",v="BLOG_DELETE",g="USERS_FETCH",E="COMMENTS_FETCH",O="COMMENT_CREATE",w="  AUTH_LOGIN",j="  AUTH_LOGOUT",y="NOTIFICATION_SHOW",k="  NOTIFICATION_CLEAR",x={token:null,name:null,username:null},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(p.a)({},e,t.data);case j:return x;default:return e}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return t.data;case d:return e.concat(t.data);case b:return e.filter(function(e){return e.id!==t.data.id}).concat(t.data);case v:return e.filter(function(e){return e.id!==t.data.id});default:return e}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return t.data;default:return e}},T={show:!1,message:null,notificationType:null},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(p.a)({},t.data,{show:!0});case k:return T;default:return e}},I=n(17),L=n(35),F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return t.data;case O:var n=Object(L.a)(Object.entries(t.data)[0],2),r=n[0],a=n[1];return Object(p.a)({},e,Object(I.a)({},r,e[r].concat(a)));default:return e}},_=Object(i.combineReducers)({auth:A,blogs:C,users:N,notification:S,comments:F}),B=Object(i.createStore)(_,Object(l.composeWithDevTools)(Object(i.applyMiddleware)(s.a))),P=n(6),D=n(7),R=n(9),U=n(8),M=n(10),z=n(72),G=n(70),H=n(67),J=n(71),W=n(2),q=n.n(W),K=n(3),Q=n(13),V=n.n(Q),X={login:function(){var e=Object(K.a)(q.a.mark(function e(t){var n;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Y=function(e,t){return window.localStorage.setItem(e,JSON.stringify(t))},Z=function(e){return window.localStorage.getItem(e)},$=function(e){return window.localStorage.removeItem(e)},ee=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return function(){var r=Object(K.a)(q.a.mark(function r(a){return q.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a(te(e,t)),setTimeout(function(){a(ne())},1e3*n);case 2:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}()},te=function(e,t){return{type:y,data:{message:e,notificationType:t}}},ne=function(){return{type:k}},re=function(){return function(){var e=Object(K.a)(q.a.mark(function e(t){return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:j}),$("user"),t(ee("Successfully logged out",m));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},ae=function(){return a.a.createElement("div",null,a.a.createElement(J.a,{exact:!0,to:"/"},"Blogs"),"\xa0",a.a.createElement(J.a,{to:"/users"},"Users"),"\xa0")},ce={logout:re},oe=Object(u.b)(function(e){return{user:e.auth}},ce)(function(e){var t=e.user;return a.a.createElement("div",null,a.a.createElement(H.a,{to:"/"},a.a.createElement("h1",{className:"header"},"BLOG APP")),a.a.createElement(ae,null),a.a.createElement("p",null,"".concat(t.name," logged in")," ",a.a.createElement("button",{onClick:re},"Log out")),a.a.createElement("p",null,a.a.createElement(H.a,{to:"/blogs/new",tag:"button"},"Create new blog")))}),ue={login:function(e){return function(){var t=Object(K.a)(q.a.mark(function t(n){var r;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X.login(e);case 3:r=t.sent,n({type:w,data:r}),Y("user",r),n(ee("".concat(r.name," successfully logged in"),m)),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),n(ee("Could not log in",f)),$("user");case 14:case"end":return t.stop()}},t,this,[[0,9]])}));return function(e){return t.apply(this,arguments)}}()}},ie=Object(u.b)(null,ue)(function(e){var t=e.login;return a.a.createElement("div",null,a.a.createElement("h1",{className:"header"},"Log in to application"),a.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n={username:e.target.username.value,password:e.target.password.value};t(n),e.target.username.value="",e.target.password.value=""}},a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"username"},"Name: "),a.a.createElement("input",{name:"username"})),a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"password"},"Password: "),a.a.createElement("input",{name:"password"})),a.a.createElement("button",{type:"submit"},"Log in")))}),le=Object(u.b)(function(e){var t=e.notification;return{message:t.message,notificationType:t.notificationType,show:t.show}})(function(e){var t=e.message,n=e.show,r=e.notificationType;if(!n)return null;var c,o={border:"1px solid ".concat(c=r===m?"#388e3c":"#d32f2f"),padding:"1rem",color:c},u=r===m?"normal":"error";return a.a.createElement("div",{style:o,className:u},t)}),se={padding:"1rem",borderBottom:"1px solid black"},pe=function(e){function t(){return Object(P.a)(this,t),Object(R.a)(this,Object(U.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){var e=this.props.blog;return a.a.createElement("div",{className:"blog-wrapper",onClick:this.onClick,style:se},a.a.createElement(H.a,{to:"/blogs/".concat(e.id)},e.title," ",e.author))}}]),t}(r.PureComponent),me={getAll:function(){var e=Object(K.a)(q.a.mark(function e(t){var n,r;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(t)}},e.next=3,V.a.get("/api/blogs",n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),createNew:function(){var e=Object(K.a)(q.a.mark(function e(t,n){var r,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,V.a.post("/api/blogs",t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(K.a)(q.a.mark(function e(t,n){var r,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,V.a.put("".concat("/api/blogs","/").concat(t.id),t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(K.a)(q.a.mark(function e(t,n){var r,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,V.a.delete("".concat("/api/blogs","/").concat(t.id),r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},fe=function(e,t){return function(){var n=Object(K.a)(q.a.mark(function n(r,a){var c,o;return q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c=a().auth.token,n.next=4,me.update(e,c);case 4:o=n.sent,r(ee(t||"New blog ".concat(o.title," created"),m)),r({type:b,data:o}),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.error(n.t0),r(ee("Error updating blog ".concat(e.title),f));case 13:case"end":return n.stop()}},n,this,[[0,9]])}));return function(e,t){return n.apply(this,arguments)}}()},he=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(R.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(a)))).componentDidMount=function(){n.props.fetchAll()},n}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){var e=this.props.blogs;return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Blogs"),e.map(function(e){return a.a.createElement(pe,{key:e.id,blog:e})}))}}]),t}(r.PureComponent),de={fetchAll:function(){return function(){var e=Object(K.a)(q.a.mark(function e(t,n){var r,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n().auth.token,e.next=4,me.getAll(r);case 4:a=e.sent,t({type:h,data:a}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t(ee("Error fetching blogs",f));case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t,n){return e.apply(this,arguments)}}()}},be=function(e){return e.sort(function(e,t){return t.likes-e.likes})},ve=Object(u.b)(function(e){return{blogs:be(e.blogs)}},de)(he),ge=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(R.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(a)))).onSubmit=function(e){e.preventDefault();var t={title:e.target.title.value,author:e.target.author.value,url:e.target.url.value};n.props.create(t),e.target.title.value="",e.target.author.value="",e.target.url.value=""},n}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Add new blog"),a.a.createElement("form",{onSubmit:this.onSubmit},a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"title"},"Title: "),a.a.createElement("input",{name:"title"})),a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"author"},"Author: "),a.a.createElement("input",{name:"author"})),a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"url"},"URL: "),a.a.createElement("input",{name:"url"})),a.a.createElement("button",{type:"submit"},"Save")))}}]),t}(r.PureComponent),Ee={create:function(e){return function(){var t=Object(K.a)(q.a.mark(function t(n,r){var a,c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=r().auth.token,t.next=4,me.createNew(e,a);case 4:c=t.sent,n(ee("New blog ".concat(c.title," created"),m)),n({type:d,data:c}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),n(ee("Error creating blog ".concat(e.title),f));case 13:case"end":return t.stop()}},t,this,[[0,9]])}));return function(e,n){return t.apply(this,arguments)}}()}},Oe=Object(u.b)(null,Ee)(ge),we=function(e){return"".concat("/api/blogs/","/").concat(e.id,"/comments")},je={getAll:function(){var e=Object(K.a)(q.a.mark(function e(t,n){var r,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,V.a.get(we(t),r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),createNew:function(){var e=Object(K.a)(q.a.mark(function e(t,n,r){var a,c;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"bearer ".concat(r)}},e.next=3,V.a.post(we(t),n,a);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},ye=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(R.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(a)))).componentDidMount=function(){n.props.fetchAll()},n.componentDidUpdate=function(e){e.blog.id!==n.props.blog.id&&n.props.fetchAll()},n}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,"Comments"),this.props.comments.map(function(e){return a.a.createElement("li",{key:e.id},e.content)}))}}]),t}(r.PureComponent),ke=Object(u.b)(function(e,t){var n=t.blog;return{comments:e.comments[n.id]||[]}},function(e,t){var n=t.blog;return{fetchAll:function(){return e(function(e){return function(){var t=Object(K.a)(q.a.mark(function t(n,r){var a,c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=r().auth.token,t.next=4,je.getAll(e,a);case 4:c=t.sent,n({type:E,data:c}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),n(ee("Error fetching comments",f));case 12:case"end":return t.stop()}},t,this,[[0,8]])}));return function(e,n){return t.apply(this,arguments)}}()}(n))}}})(ye),xe=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(R.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(a)))).onSubmit=function(e){e.preventDefault();var t=e.target.comment.value;n.props.create({content:t}),e.target.comment.value=""},n}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("form",{onSubmit:this.onSubmit},a.a.createElement("div",null,a.a.createElement("input",{name:"comment",placeholder:"Comment"})),a.a.createElement("button",{type:"submit"},"Add")))}}]),t}(r.PureComponent),Ae=Object(u.b)(null,function(e,t){var n=t.blog;return{create:function(t){return e(function(e,t){return function(){var n=Object(K.a)(q.a.mark(function n(r,a){var c,o;return q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c=a().auth.token,n.next=4,je.createNew(e,t,c);case 4:o=n.sent,r(ee("New comment ".concat(o.content," for blog ").concat(e.title," created"),m)),r({type:O,data:o}),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.error(n.t0),r(ee("Error creating comment ".concat(t.title),f));case 13:case"end":return n.stop()}},n,this,[[0,9]])}));return function(e,t){return n.apply(this,arguments)}}()}(n,t))}}})(xe);var Ce={addLike:function(e){return function(){var t=Object(K.a)(q.a.mark(function t(n){var r;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{r=Object(p.a)({},e,{likes:e.likes+1}),n(fe(r,"Like added to ".concat(e.title)))}catch(a){console.error(a),n(ee("Error adding like to a blog ".concat(e.title),f))}case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},addComment:function(e,t){return function(){var n=Object(K.a)(q.a.mark(function n(r){var a;return q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t.length){n.next=3;break}return n.abrupt("return",r(ee("Please write some comment first",f)));case 3:a=Object(p.a)({},e,{comments:e.comments.concat(t)}),r(fe(a,"Comment ".concat(t," added to ").concat(e.title))),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0),r(ee("Error adding comment to a blog ".concat(e.title),f));case 11:case"end":return n.stop()}},n,this,[[0,7]])}));return function(e){return n.apply(this,arguments)}}()},remove:function(e){return function(){var t=Object(K.a)(q.a.mark(function t(n,r){var a;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=r().auth.token,t.next=4,me.remove(e,a);case 4:n(ee("Blog ".concat(e.title," removed"),m)),n({type:v,data:e}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),n(ee("Error removing blog ".concat(e.title),f));case 12:case"end":return t.stop()}},t,this,[[0,8]])}));return function(e,n){return t.apply(this,arguments)}}()}},Ne=Object(u.b)(function(e,t){var n=t.blogId,r=e.blogs.find(function(e){return e.id===n}),a=e.auth.username;return{blog:r,showRemove:r&&r.user&&r.user.username===a}},Ce)(function(e){var t=e.blog,n=e.addLike,r=(e.addComment,e.remove),c=e.showRemove;return t?a.a.createElement("div",null,a.a.createElement("h1",null,t.title),a.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:t.url},"Read the blog"),a.a.createElement("div",{className:"blog-details"},t.likes," likes ",a.a.createElement("button",{onClick:function(){return n(t)}},"Like"),t.user&&"Added by ".concat(t.user.name),a.a.createElement("br",null)),c&&a.a.createElement("button",{className:"remove-button",onClick:function(){return r(t)}},"Remove"),a.a.createElement(ke,{blog:t}),a.a.createElement(Ae,{blog:t})):a.a.createElement("p",null,"Blog not found")}),Te={padding:"1rem",borderBottom:"1px solid black"},Se=function(e){function t(){return Object(P.a)(this,t),Object(R.a)(this,Object(U.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){var e=this.props.user;return a.a.createElement("div",{className:"user-wrapper",onClick:this.onClick,style:Te},a.a.createElement(H.a,{to:"/users/".concat(e.id)},e.name," ",e.blogs.length))}}]),t}(r.PureComponent),Ie={getAll:function(){var e=Object(K.a)(q.a.mark(function e(t){var n,r;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(t)}},e.next=3,V.a.get("/api/users",n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Le=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(R.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(a)))).componentDidMount=function(){n.props.fetchAll()},n}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){var e=this.props.users;return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Users"),e.map(function(e){return a.a.createElement(Se,{key:e.id,user:e})}))}}]),t}(r.PureComponent),Fe={fetchAll:function(){return function(){var e=Object(K.a)(q.a.mark(function e(t,n){var r,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n().auth.token,e.next=4,Ie.getAll(r);case 4:a=e.sent,t({type:g,data:a}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t(ee("Error fetching users",f));case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t,n){return e.apply(this,arguments)}}()}},_e=function(e){return e.sort(function(e,t){return t.blogs.length-e.blogs.length})},Be=Object(u.b)(function(e){return{users:_e(e.users)}},Fe)(Le);var Pe=Object(u.b)(function(e,t){var n=t.userId;return{user:e.users.find(function(e){return e.id===n})}})(function(e){var t=e.user;return t?a.a.createElement("div",null,a.a.createElement("h1",null,t.name),a.a.createElement("h3",null,"Added blogs"),a.a.createElement("ul",null,t.blogs.map(function(e){return a.a.createElement("li",{key:e._id},e.title)}))):a.a.createElement("p",null,"User not found")}),De=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(R.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(a)))).componentDidMount=function(){n.props.checkAuth()},n.handleLogOut=function(){n.props.logout()},n}return Object(M.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){var e=this.props.user;return a.a.createElement("div",null,a.a.createElement(le,null),null==e.token?a.a.createElement(ie,null):a.a.createElement(z.a,null,a.a.createElement(a.a.Fragment,null,a.a.createElement(oe,null),a.a.createElement(a.a.Fragment,null,a.a.createElement(G.a,{path:"/",exact:!0,component:ve}),a.a.createElement(G.a,{path:"/blogs/new",component:Oe}),a.a.createElement(G.a,{path:"/blogs/:blogId",render:function(e){var t=e.match;return a.a.createElement(Ne,{blogId:t.params.blogId})}}),a.a.createElement(G.a,{path:"/blogs",component:ve}),a.a.createElement(G.a,{path:"/users/:userId",render:function(e){var t=e.match;return a.a.createElement(Pe,{userId:t.params.userId})}}),a.a.createElement(G.a,{path:"/users",component:Be})))))}}]),t}(a.a.Component),Re={logout:re,checkAuth:function(){return function(e){var t=Z("user");if(t){var n=JSON.parse(t);e({type:w,data:n})}}}},Ue=Object(u.b)(function(e){return{user:e.auth}},Re)(De);o.a.render(a.a.createElement(u.a,{store:B},a.a.createElement(Ue,null)),document.getElementById("root"))}},[[36,2,1]]]);
//# sourceMappingURL=main.164418ec.chunk.js.map